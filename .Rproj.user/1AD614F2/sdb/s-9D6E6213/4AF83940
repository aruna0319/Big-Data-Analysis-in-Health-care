{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#cl\n\nlibrary(shiny)\nlibrary(maps)\nlibrary(mapproj)\nlibrary(devtools)\nlibrary(rHighcharts)\nlibrary(datasets)\npatient <- read.csv(\"patient.csv\")\ndata(patient)\n\n#source(\"./data/helpers.R\")\n#patient <- read.csv(\"./data/patient.csv\")\npatient_state_discharges <- aggregate(patient$Total.Discharges ~ patient$Provider.State,data=patient,sum)\npatient_state_discharges <- patient_state_discharges[order(-patient_state_discharges[[2]]),]\n\n#Average.Covered.Charges\npatient_state_charges <- aggregate(patient$Average.Covered.Charges ~ patient$Provider.State,data=patient,sum)\npatient_state_charges <- patient_state_charges[order(-patient_state_charges[[2]]),]\n\n#Average.Total.Payments\npatient_avg_total_payment <- aggregate(patient$Average.Total.Payments ~ patient$Provider.State,data=patient,sum)\npatient_avg_total_payment <- patient_avg_total_payment[order(-patient_avg_total_payment[[2]]),]\n\n#Average.Medicare.Payments\npatient_avg_Medi_payment <- aggregate(patient$Average.Medicare.Payments ~ patient$Provider.State,data=patient,sum)\npatient_avg_Medi_payment <- patient_avg_Medi_payment[order(-patient_avg_Medi_payment[[2]]),]\n\ntags$head(tags$style(\"#text1{color: red;\n                                 font-size: 20px;\n                                 font-style: italic;\n                                 }\"\n)\n)\n\nshinyServer(function(input, output) {\n  \n  output$dataname <- renderText({\n    \n    paste(\"Structure of dataset\", input$dataset)\n  })\n  \n  output$structure <- renderPrint({\n    \n    str(get(input$dataset))\n  })\n  \n  output$observation <- renderText({\n    \n    input$act\n    isolate(paste(\"First\",input$obs,\"Observations of the dataset\",input$dataset))\n  })\n  \n  output$view <- renderTable({\n    input$act\n    isolate(head(get(input$dataset), n = input$obs))\n  })\n  \n#   output$count <- renderText({\n#       if(!infile.exists(\"C:/Users/Aruna/Desktop/CMPE 274/FinalProject/counter.Rdata\"))\n#         counter <- 0\n#       else\n#         load(file=\"C:/Users/Aruna/Desktop/CMPE 274/HealthCare_DataAnalysis-master/counter.Rdata\")\n#         counter <- counter + 1\n#       save(counter,file=\"C:/Users/Aruna/Desktop/CMPE 274/HealthCare_DataAnalysis-master/counter.Rdata\")\n#       paste(\"Hits:\" ,counter)\n#     })\n    \n  \n  output$test <- renderUI(input$var)\n\n  output$sum <- renderPrint({\n    summary(get(input$dataset))\n  })\n  output$str <- renderPrint({\n    \n    str(patient)\n  })\n  \n  \n  output$data <- renderTable({\n    \n    colm <- as.numeric(input$var)\n    #iris[colm]\n    head(get(input$dataset))\n    \n    \n  })\n  \n  output$allCharges_mix <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Cumulative Chart for Various Charges\")\n    a$subtitle(text = \"\")\n    a$xAxis(categories = patient_state_discharges[[1]][1:10])\n    a$yAxis(title = list(text = \"Numbers\"))\n    \n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], color='green',type = \"column\", name = \"Total Discharges\")\n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color=input$color,type = \"column\", name = \"Covered Charges\")\n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], color='blue', type = \"line\", name = \"Avg total Payments\")\n    a$data(x = patient_avg_Medi_payment[[1]][1:10], y = patient_avg_Medi_payment[[2]][1:10], color='green',type = \"line\", name = \"Average Medicare Payments\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    a$data(x= NULL)\n    return(a)\n  })\n  \n  output$allCharges_line <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Cumulative Chart for Various Charges\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_discharges[[1]][1:10])\n    a$yAxis(title = list(text = \"Numbers\"))\n    \n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], color='green',type = \"column\", name = \"Total Discharges\")\n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color=input$color,type = \"line\", name = \"Covered Charges\")\n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], color='blue', type = \"line\", name = \"Avg total Payments\")\n    a$data(x = patient_avg_Medi_payment[[1]][1:10], y = patient_avg_Medi_payment[[2]][1:10], color='green',type = \"line\", name = \"Average Medicare Payments\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    a$data(x= NULL)\n    return(a)\n  })\n  \n  output$allCharges_column <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Cumulative Chart for Various Charges\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_discharges[[1]][1:10])\n    a$yAxis(title = list(text = \"Numbers\"))\n    \n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], color='green',type = \"column\", name = \"Total Discharges\")\n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color=input$color,type = \"column\", name = \"Covered Charges\")\n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], color='blue', type = \"column\", name = \"Avg total Payments\")\n    a$data(x = patient_avg_Medi_payment[[1]][1:10], y = patient_avg_Medi_payment[[2]][1:10], color='green',type = \"column\", name = \"Average Medicare Payments\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalDischarges_line <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Total Discharges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_discharges[[1]][1:10])\n    a$yAxis(title = list(text = \"Number of Total Discharges\"))\n    \n    a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"line\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalDischarges_bar <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Total Discharges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_discharges[[1]][1:10])\n    a$yAxis(title = list(text = \"Number of Total Discharges\"))\n    \n    a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalDischarges_pie <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Total Discharges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_discharges[[1]][1:10])\n    a$yAxis(title = list(text = \"Number of Total Discharges\"))\n    \n    a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"pie\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n\n  output$totalDischarges_column <- renderChart({\n    \n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Total Discharges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_charges[[1]][1:10])\n    a$yAxis(title = list(text = \"Number of Total Discharges\"))\n    \n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color='green',type = \"column\", name = \"Total Discharges\")\n    #a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color='red',type = \"column\", name = \"Covered Charges\")\n    #a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], color='blue', type = \"column\", name = \"Avg total Payments\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    a$data(x= NULL)\n    return(a)\n  })\n  \n  output$coveredCharges_column <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Covered charges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_charges[[1]][1:10])\n    a$yAxis(title = list(text = \"Covered Charges\"))\n    \n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color='purple',type = \"column\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$coveredCharges_line <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Covered charges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_charges[[1]][1:10])\n    a$yAxis(title = list(text = \"Covered Charges\"))\n    \n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color='red',type = \"line\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$coveredCharges_bar <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Covered charges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_charges[[1]][1:10])\n    a$yAxis(title = list(text = \"Covered Charges\"))\n    \n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], color='green',type = \"bar\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$coveredCharges_pie <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Covered charges per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_state_charges[[1]][1:10])\n    a$yAxis(title = list(text = \"Covered Charges\"))\n    \n    a$data(x = patient_state_charges[[1]][1:10], y = patient_state_charges[[2]][1:10], type = \"pie\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalPayment_column <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Avg total Payments per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_avg_total_payment[[1]][1:10])\n    a$yAxis(title = list(text = \"Avg Total Payments\"))\n    \n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], color='pink',type = \"column\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalPayment_line <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Avg total Payments per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_avg_total_payment[[1]][1:10])\n    a$yAxis(title = list(text = \"Avg Total Payments\"))\n    \n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], color='yellow', type = \"line\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalPayment_bar <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Avg total Payments per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_avg_total_payment[[1]][1:10])\n    a$yAxis(title = list(text = \"Avg Total Payments\"))\n    \n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n  output$totalPayment_pie <- renderChart({\n    a <- rHighcharts:::Chart$new()\n    a$title(text = \"Avg total Payments per State\")\n    a$subtitle(text = \"unit 1K = 1000\")\n    a$xAxis(categories = patient_avg_total_payment[[1]][1:10])\n    a$yAxis(title = list(text = \"Avg Total Payments\"))\n    \n    a$data(x = patient_avg_total_payment[[1]][1:10], y = patient_avg_total_payment[[2]][1:10], type = \"pie\", name = \"state\")\n    #a$data(x = patient_state_discharges[[1]][1:10], y = patient_state_discharges[[2]][1:10], type = \"bar\", name = \"state\")\n    #a$data(x = data$month, y = data$N.ended, type = \"column\", name = \"Ended\")\n    #a$data(x= NULL)\n    return(a)\n  })\n  \n\n})\n",
    "created" : 1444858256509.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1912788828",
    "id" : "4AF83940",
    "lastKnownWriteTime" : 1444859611,
    "path" : "C:/Users/Aruna/Desktop/CMPE 274/HealthCare_DataAnalysis-master/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}